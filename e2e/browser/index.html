<html>
  <head>
    <style>
      table {
        border-collapse: collapse;
        width: 100%;
      }
      table,
      tr,
      td {
        border: 1px solid black;
        padding: 10px;
      }
      #results-row {
        width: 100%;
      }
    </style>
    <script src="/dist/orbs-client-sdk.js"></script>
    <script>
      function CreateOrbsClient() {
        let result;
        try {
          const endpoint = document.querySelector("#endpoint").value;
          const virtualChainId = document.querySelector("#virtual-chain-id").value;
          window.orbsClient = new Orbs.Client(endpoint, virtualChainId, "TEST_NET");
          result = "Created";
        } catch (e) {
          result = "Failed";
        }
        document.querySelector("#orbs-client-result").innerText = result;
      }

      function CreateAccount1() {
        window.account1 = Orbs.createAccount();
        document.querySelector("#account-1-id").innerText = window.account1.publicKey;
      }

      function CreateAccount2() {
        window.account2 = Orbs.createAccount();
        document.querySelector("#account-2-id").innerText = window.account2.publicKey;
      }

      function CreateTx() {
        const [tx, txId] = window.orbsClient.createTransaction(window.account1.publicKey, window.account1.privateKey, "BenchmarkToken", "transfer", [new Orbs.ArgUint64(10), new Orbs.ArgAddress(window.account2.address)]);
        window.tx = tx;
        window.txId = txId;
        document.querySelector("#tx-id").innerText = txId;
      }

      function SendTx() {
        window.orbsClient.sendTransaction(window.tx).then(transferResponse => {
          document.querySelector("#transfer-response-request-status").innerText = transferResponse.requestStatus;
          document.querySelector("#transfer-response-execution-result").innerText = transferResponse.executionResult;
          document.querySelector("#transfer-response-transaction-status").innerText = transferResponse.transactionStatus;
        });
      }

      function GetTxStatus() {
        window.orbsClient.getTransactionStatus(window.txId).then(statusResponse => {
          document.querySelector("#status-response-request-status").innerText = statusResponse.requestStatus;
          document.querySelector("#status-response-execution-result").innerText = statusResponse.executionResult;
          document.querySelector("#status-response-transaction-status").innerText = statusResponse.transactionStatus;
        });
      }

      function GetTxReceiptProof() {
        window.orbsClient.getTransactionReceiptProof(window.txId).then(txProofResponse => {
          document.querySelector("#proof-response-request-status").innerText = txProofResponse.requestStatus;
          document.querySelector("#proof-response-execution-result").innerText = txProofResponse.executionResult;
          document.querySelector("#proof-response-transaction-status").innerText = txProofResponse.transactionStatus;
          document.querySelector("#proof-response-packedproof-bytelength").innerText = txProofResponse.packedProof.byteLength;
          document.querySelector("#proof-response-packedreceipt-bytelength").innerText = txProofResponse.packedReceipt.byteLength;
        });
      }
    </script>
  </head>
  <body>
    <form>
      <div><label for="endpoint">Gamma url:</label> <input id="endpoint" name="endpoint" type="text" placeholder="endpoint" value="http://localhost:8081" /></div>
      <div><label for="virtual-chain-id">Virtual Chain Id:</label> <input id="virtual-chain-id" name="virtual-chain-id" type="text" placeholder="virtual chain id" value="42" /></div>
    </form>
    <table>
      <thead>
        <tr>
          <td>Step</td>
          <td>Action</td>
          <td id="results-row">Result</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td><button id="create-orbs-client" onclick="CreateOrbsClient()">Create Orbs.Client</button></td>
          <td id="orbs-client-result"></td>
        </tr>
        <tr>
          <td>2</td>
          <td><button id="create-account-1" onclick="CreateAccount1()">Create Account 1</button></td>
          <td id="account-1-id"></td>
        </tr>
        <tr>
          <td>3</td>
          <td><button id="create-account-2" onclick="CreateAccount2()">Create Account 2</button></td>
          <td id="account-2-id"></td>
        </tr>
        <tr>
          <td>4</td>
          <td><button id="create-tx" onclick="CreateTx()">Create Tx</button></td>
          <td id="tx-id"></td>
        </tr>
        <tr>
          <td>5</td>
          <td><button id="send-tx" onclick="SendTx()">Send Tx</button></td>
          <td>
            <div><span>Transfer Response request status:</span> <span id="transfer-response-request-status"></span></div>
            <div><span>Transfer Response execution result:</span> <span id="transfer-response-execution-result"></span></div>
            <div><span>Transfer Response transaction status:</span> <span id="transfer-response-transaction-status"></span></div>
          </td>
        </tr>
        <tr>
          <td>6</td>
          <td><button id="get-tx-status" onclick="GetTxStatus()">Get Tx status</button></td>
          <td>
            <div><span>Status Response request status:</span> <span id="status-response-request-status"></span></div>
            <div><span>Status Response execution result:</span> <span id="status-response-execution-result"></span></div>
            <div><span>Status Response transaction status:</span> <span id="status-response-transaction-status"></span></div>
          </td>
        </tr>
        <tr>
          <td>6</td>
          <td><button id="get-tx-receipt-proof" onclick="GetTxReceiptProof()">Get Tx receipt proof</button></td>
          <td>
            <div><span>Proof Response request status:</span> <span id="proof-response-request-status"></span></div>
            <div><span>Proof Response execution result:</span> <span id="proof-response-execution-result"></span></div>
            <div><span>Proof Response transaction status:</span> <span id="proof-response-transaction-status"></span></div>
            <div><span>Proof Response packed proof byteLength:</span> <span id="proof-response-packedproof-bytelength"></span></div>
            <div><span>Proof Response packed receipt byteLength:</span> <span id="proof-response-packedreceipt-bytelength"></span></div>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>
